<html>

<head>
  <style>
    /* canvas{ border: 1px solid black; width: 100%; height: 100% } */
  </style>
  <title></title>
</head>

<body bgcolor="black">
  <canvas id="myChart"></canvas>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

  <script>
    var ctx = document.getElementById('myChart').getContext('2d');

    // ctx.fillStyle = "black";
    // ctx.fillRect(0, 0, canvas.width, canvas.height);

    var chart = new Chart(ctx, {
      // The type of chart we want to create
      type: 'bar',

      // The data for our dataset
      data: {
        labels: {{ myNames|safe }},
        datasets: [{
          label: 'My First dataset',
          backgroundColor: 'rgb(50, 50, 50)',
          borderColor: 'rgb(255, 100, 100)',
          borderWidth: 2,
          data: {{ myData|safe }}
        }]
      },

      // Configuration options go here
      options: {
        responsive: true,
        
        legend: {
          display: false
        },
        scales: {
          yAxes: [{
            gridLines: {
              display: true,
              drawBorder: false
            },
            ticks: {
              suggestedMax: 10,
              beginAtZero: true,
              display: true
            }
          }]
          ,
          xAxes: [{
            gridLines: {
              display: false,
              drawBorder: false,
            },
            ticks: {

              fontSize: 20,
              fontColor: 'rgb(255, 100, 100)'
            },
            // labels: {
            //   defaultFontSize: 30
            // }
          }]
        },
        events: ['click'],
        onClick: graphClickEvent
      }
    });

    function graphClickEvent(event, array) {
      // console.log(event);
      idx = this.scales['x-axis-0'].getValueForPixel(event.x);
      // console.log(xLabel);
      // alert("clicked x-axis area: " + xLabel.format('MMM YYYY'));
      // if (array[0]) {
      //   idx = array[0]['_index']
      //   // console.log(idx);
      chart.data.datasets[0].data[idx]++;
      chart.update();  
      $.getJSON('/background_process_test',{idx: idx},
      function(data) {

      });
      // }

    }

    // onClick: function(e) {
    //   var xLabel = this.scales['x-axis-0'].getValueForPixel(e.x);
    //   console.log(xLabel.format('MMM YYYY'));
    //   alert("clicked x-axis area: " + xLabel.format('MMM YYYY'));
    // },


  </script>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script type=text/javascript>

    jQuery(document).on('keydown', 'input.large', function(ev) {
        if(ev.key === 'Enter') {
            // Will change backgroundColor to blue as example
            this.style.backgroundColor = '#EFF';
            $.getJSON('/update',{name: this.value},
            function(data) {
              chart.data.datasets[0].data = data['data'];
              chart.data.labels= data['names'];
              chart.update();  
            });
            this.value = "";
            // Avoid form submit
            return false;
        }
    });
  </script> 

  <div class='container'>
        <form>
            <input id="subject" type="text" class="large" name="subject">
        </form>
  </div>
</body>

</html>